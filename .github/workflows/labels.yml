name: Get Labels for Pull Request

on:
  push:

jobs:
  get-labels:
    runs-on: ubuntu-latest
    steps:
      - name: Get PR number
        id: pr-number
        run: |
          PR_NUMBER=$(curl -s "https://api.github.com/repos/${GITHUB_REPOSITORY}/pulls?head=${GITHUB_REF}" | jq -r '.[0].number')
          echo "pr-number=${PR_NUMBER}" >> $GITHUB_OUTPUT


      - name: Get labels for PR
        id: labels
        if: steps.pr-number.outputs.pr-number != 'null'
        run: |
          PR_NUMBER="${{ steps.pr-number.outputs.pr-number }}"
          LABELS=$(curl -s "https://api.github.com/repos/${GITHUB_REPOSITORY}/issues/${PR_NUMBER}/labels" | jq -r '.[].name')
          echo "labels=${LABELS}" >> $GITHUB_OUTPUT

      - name: Output labels
        run: |
          if [[ "${{ steps.labels.outputs.labels }}" == "" ]]; then
            echo "No labels found for the pull request."
          else
            echo "Labels for the pull request:"
            IFS=', ' read -r -a labels_array <<< "${{ steps.labels.outputs.labels }}"
            for label in "${labels_array[@]}"; do
              echo "$label"
            done
          fi
